<!DOCTYPE html>
<html>
  <head>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
  <meta charset="utf-8">
    <title>France Soccer Map</title>
	
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
	  
	  .records {
	    display: none;
	  }
	  
	  .legend {
		font-family: Arial, sans-serif;
		font-size: 12px;
		font-weight: bold;
		background: #fff;
		opacity: 0.85;
		padding: 5px;
		margin: 5px;
		border: 2px solid #999;
		box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
	  }
	  
	  a:link{
	    text-decoration:none;
		color: #ccc;
	  } 
	  
	  a:visited {
	    text-decoration:none;
		color: #666;
	  }
	  
	  a:hover, a:active {
	    text-decoration:underline;
	  }
    </style>

	<link rel="stylesheet"
        href="https://code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css">
		
	<link rel="shortcut icon" href="icons/favicon.ico">
		<link rel="icon" sizes="16x16 32x32 64x64" href="icons/favicon.ico">
		<link rel="icon" type="image/png" sizes="196x196" href="icons/favicon-196.png">
		<link rel="icon" type="image/png" sizes="160x160" href="icons/favicon-160.png">
		<link rel="icon" type="image/png" sizes="96x96" href="icons/favicon-96.png">
		<link rel="icon" type="image/png" sizes="64x64" href="icons/favicon-64.png">
		<link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16.png">
		<link rel="apple-touch-icon" sizes="152x152" href="icons/favicon-152.png">
		<link rel="apple-touch-icon" sizes="144x144" href="icons/favicon-144.png">
		<link rel="apple-touch-icon" sizes="120x120" href="icons/favicon-120.png">
		<link rel="apple-touch-icon" sizes="114x114" href="icons/favicon-114.png">
		<link rel="apple-touch-icon" sizes="76x76" href="icons/favicon-76.png">
		<link rel="apple-touch-icon" sizes="72x72" href="icons/favicon-72.png">
		<link rel="apple-touch-icon" href="icons/favicon-57.png">
		<meta name="msapplication-TileColor" content="#FFFFFF">
		<meta name="msapplication-TileImage" content="icons/favicon-144.png">
		<meta name="msapplication-config" content="icons/browserconfig.xml">
	
    <script type="text/javascript"
        src="https://maps.google.com/maps/api/js?sensor=false"></script>
		
	<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
	
	<script type="text/javascript" src="https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
	
	<!-- future project
	<script type="text/javascript" src="lib/js/markerclusterer.js"></script> 
	-->
	
    <script type="text/javascript">
	


		
		var map;
		
		var table1Id = '1orcuHvlukgV5d_HaEMS_ulRU_aMsS34iFLWH0MTA';
		var table2Id = '1AP9m8NBpnofSW8IBhqN-m75IEusMeIkfSXFfAPLQ';
		var table3Id = '1UFUBD1W_VzGdFLWXHjxU4DShBPQKbSFhmvcE42lo';

		var locCountry = 'col29>>1';
		var locCity = 'col35';			 
			 
		var layer1 = new google.maps.FusionTablesLayer;		
		var layer2 = new google.maps.FusionTablesLayer;	 
		var layer3 = new google.maps.FusionTablesLayer({
			styleId: 2,
			templateId: 3
		});
	
		function initialize() {
		
			map = new google.maps.Map(document.getElementById('map-canvas'), {
			center: new google.maps.LatLng(20, 12),
			zoom: 3,
			streetViewControl: false,
			mapTypeControl: false
			});
			
			var style = [
					{
					  featureType: 'all',
					  elementType: 'all',
					  stylers: [
						{ saturation: -90 },
						{ lightness: 85 },
						{ gamma: 0.22 },
						{ hue: "#6699cc" }
					  ]
					},
					{
					  featureType: 'road',
					  elementType: 'all',
					  stylers: [
						{ visibility: 'off' }
					  ]
					},
					{
					  featureType: 'poi',
					  elementType: 'all',
					  stylers: [
						{ visibility: 'simplified' }
					  ]
					},
					{
					  featureType: 'administrative.country',
					  elementType: 'all',
					  stylers: [
						{ visibility: 'simplified' }
					  ]
					},
					{
					  featureType: 'administrative.province',
					  elementType: 'all',
					  stylers: [
						{ visibility: 'off' }
					  ]
					},
					{
					  featureType: 'administrative.locality',
					  elementType: 'all',
					  stylers: [
						{ visibility: 'on' }
					  ]
					},
					{
					  featureType: 'administrative.neighborhood',
					  elementType: 'all',
					  stylers: [
						{ visibility: 'off' }
					  ]
					},
					{
					  featureType: 'administrative.land_parcel',
					  elementType: 'all',
					  stylers: [
						{ visibility: 'off' }
					  ]
					},
					{
					  featureType: 'water',
					  elementType: 'all',
					  stylers: [
						{ visibility: 'simplified' },
						{ "color": "#f8f8f8" }
					  ]
					},
					{
					  featureType: 'transit',
					  elementType: 'all',
					  stylers: [
						{ visibility: 'off' }
					  ]
					}
				  ];
				  
			var styledMapType = new google.maps.StyledMapType(style, {
				map: map,
				name: 'Styled Map'
			});
				  
			map.mapTypes.set('map-style', styledMapType);
			map.setMapTypeId('map-style');
			
			layer1.setMap(null);
			
			layer2.setMap(null);
	  
			layer3.setMap(null);			
			
			sliderInput();
			
			filter();
			
			google.maps.event.addDomListener(document.getElementById('winBox'),
				'click', function() {
				  filter();
			});

			google.maps.event.addDomListener(document.getElementById('drawBox'),
				'click', function() {
				  filter();
			});

			google.maps.event.addDomListener(document.getElementById('lossBox'),
				'click', function() {
				  filter();
			});
				
			google.maps.event.addDomListener(document.getElementById('futureBox'),
				'click', function() {
				  filter();
			});				
					  
			google.maps.event.addDomListener(document.getElementById('countries'),
				'change', function() {
				  filter();
			});
				
			google.maps.event.addDomListener(document.getElementById('gametype'),
				'change', function() {
				  filter();
			});		
			
		}
			
			function filter() {
			  var whereClause = '';
			  var whereClause2 = '';
			  var whereClause3 = '';
			  var selectCountry = document.getElementById('countries').value.replace(/'/g, "\\'");
			  var selectGametype = document.getElementById('gametype').value.replace(/'/g, "\\'");
			  var selectResult = document.getElementsByName('game');
			  var minYear = $( "#slider-range" ).slider( "values", 0 );
			  var maxYear = $( "#slider-range" ).slider( "values", 1 );
			  var whereWDL;
			  var checkboxes = [];

			  function filter2() {
			  
			    function generateCheckboxes() {
				  for (var i = 0, game; game = selectResult[i]; i++) {
				    if (game.checked) {
					  var result = game.value.replace(/'/g, '\\\'');
					  checkboxes.push("'" + result + "'");
				    }
				  }
				  if (checkboxes.length) {
				    return (checkboxes);
				  }				  
			    }
				
			    if (selectCountry != '--Select--') {
					if (selectCountry === 'GermanyTotal') {
					  generateCheckboxes();
					  whereClause = "'country' IN ('" + selectCountry + "')";
					  whereClause2 = "'WDL' IN (" + checkboxes.join(',') + ") AND 'country' IN ('Germany', 'West Germany', 'German Reich', 'Weimar Republic') AND 'yyyy' <= '" + maxYear + "' AND 'yyyy' >= '" + minYear + "'";
					  whereClause3 = "'F(0)/P(1)' = '" + selectGametype + "' AND 'country' IN ('Germany', 'West Germany', 'Germany Reich', 'Weimar Republic') AND 'WDL' IN (" + checkboxes.join(',') + ") AND 'yyyy' <= '" + maxYear + "' AND 'yyyy' >= '" + minYear + "'";
					} else {				
					  generateCheckboxes();
					  whereClause = "'country' IN ('" + selectCountry + "')";
					  whereClause2 = "'WDL' IN (" + checkboxes.join(',') + ") AND 'country' IN ('" +
						selectCountry + "') AND 'yyyy' <= '" + maxYear + "' AND 'yyyy' >= '" + minYear + "'";
					  whereClause3 = "'F(0)/P(1)' = '" + selectGametype + "' AND 'country' IN ('" +
						selectCountry + "') AND 'WDL' IN (" + checkboxes.join(',') + ") AND 'yyyy' <= '" + maxYear + "' AND 'yyyy' >= '" + minYear + "'";
					}
				} else {
				  generateCheckboxes();
				  whereClause2 = "'WDL' IN (" + checkboxes.join(',') + ") AND 'yyyy' <= '" + maxYear + "' AND 'yyyy' >= '" + minYear + "'";
				  whereClause3 = "'F(0)/P(1)' = '" + selectGametype + "' AND 'WDL' IN (" +
				    checkboxes.join(',') + ") AND 'yyyy' <= '" + maxYear + "' AND 'yyyy' >= '" + minYear + "'";
				}
				
				layer1.setOptions({
				  query: {
				    select: locCountry,
				    from: table1Id,
				    where: whereClause
				  },
				  map: map
			    });
				layer2.setOptions({
				  query: {
				    select: locCountry,
				    from: table2Id,
				    where: whereClause
				  },
				  map: map
			    });
	
				return(whereClause2);				
				return(whereClause3);
				return(checkboxes);
			  }

			  if (selectGametype === '--Select--') {
				filter2();
				layer1.setOptions({
				  styleId: 2,
				  templateId: 3
			    });
				layer2.setOptions({
				  styleId: 2,
				  templateId: 3
				});
				if (checkboxes.length) {
					layer3.setOptions({
					  query: {
						select: locCity,
						from: table3Id,
						where: whereClause2		  
					  },
					  map: map
					});
					set_totals(whereClause2);
				} else {
					layer3.setMap(null);
					$('#winTotal').html(0);
					$('#drawTotal').html(0);
					$('#lossTotal').html(0);
					$('#futureTotal').html(0);					
				}				
			  } else if (selectGametype === '1') {				  
				filter2();
				layer1.setOptions({
				  styleId: 3,
				  templateId: 4
			    });	
				layer2.setOptions({
				  styleId: 3,
				  templateId: 4
			    });	
				if (checkboxes.length) {
					layer3.setOptions({
					  query: {
						select: locCity,
						from: table3Id,
						where: whereClause3		  
					  },
					  map: map
					});
					set_totals(whereClause3);
				} else {
					layer3.setMap(null);
					$('#winTotal').html(0);
					$('#drawTotal').html(0);
					$('#lossTotal').html(0);
					$('#futureTotal').html(0);					
				}
			  } else if (selectGametype === '0') {				  
				filter2();
				layer1.setOptions({
				  styleId: 4,
				  templateId: 5
			    });			
				layer2.setOptions({
				  styleId: 4,
				  templateId: 5
				});		
				if (checkboxes.length) {
					layer3.setOptions({
					  query: {
						select: locCity,
						from: table3Id,
						where: whereClause3		  
					  },
					  map: map
					});
					set_totals(whereClause3);
				} else {
					layer3.setMap(null);
					$('#winTotal').html(0);
					$('#drawTotal').html(0);
					$('#lossTotal').html(0);
					$('#futureTotal').html(0);				
				}
			  } else {
				alert('something went wrong');
			  }			  
			}
			
		function set_totals(filter_clause) {
			var win_total;
			var draw_total;
			var loss_total;
			var future_total;
		
			var query = "SELECT SUM('W'), SUM('D'), SUM('L'), SUM('U') FROM " +
            table3Id + " WHERE " + filter_clause;
			var encodedQuery = encodeURIComponent(query);

			var url = ['https://www.googleapis.com/fusiontables/v1/query'];
			url.push('?sql=' + encodedQuery);
			url.push('&key=AIzaSyAT76tcYefMoGlGrAgBhFFF22W8JhQyQBI');
			url.push('&callback=?');
			
			$.ajax({
			  url: url.join(''),
			  dataType: 'jsonp',
			  success: function (data) {
				if (data['rows']) {			  
				   win_total = data['rows'][0][0];
				   draw_total = data['rows'][0][1];
				   loss_total = data['rows'][0][2];
				   future_total = data['rows'][0][3];
			    } else {
				   win_total = 0;
				   draw_total = 0;
				   loss_total = 0;
				   future_total = 0;				
				}
			  
			   $('#winTotal').html(win_total);
			   $('#drawTotal').html(draw_total);
			   $('#lossTotal').html(loss_total);
			   $('#futureTotal').html(future_total);			  
			  
			  }
			});
		}
 
		google.maps.event.addDomListener(window, 'load', initialize);
		
		
		
		function sliderInput() {
		
			var minYear = document.getElementById('yearMin').value;
			var maxYear = document.getElementById('yearMax').value;
		
			$(function() {
				$( "#slider-range" ).slider({
				  range: true,
				  min: 1904,
				  max: 2015,
				  values: [ minYear, maxYear ],
				  slide: function( event, ui ) {
					$( "#yearMin" ).val( ui.values[ 0 ] );
					$( "#yearMax" ).val( ui.values[ 1 ] );
				  }
				});
				$( "#yearMin" ).val( $( "#slider-range" ).slider( "values", 0 ) );
				$( "#yearMax" ).val( $( "#slider-range" ).slider( "values", 1 ) );
				$( "#slider-range" ).on( "slidechange", function( event, ui ) { filter() }  );
			});
		}

    </script>
 
  </head>
  <body>
	<div id="map-canvas"></div>
	
	<div id="sample" style="!important; position: absolute; left: 400px; top: 350px; font-size:100px;">THIS IS A SAMPLE</div>
	
	<div class="legend" style="position: absolute; left: 80px; top: 10px;">
		<label>
			<select id="countries" onchange="filter(this.value);" style="border:1; border-color:#ccc; font-family: Arial, sans-serif; font-size: 12px;">
				<option value="--Select--">OPPONENT</option>
				<option value='Albania'>Albania</option>
				<option value='Algeria'>Algeria</option>
				<option value='Andorra'>Andorra</option>
				<option value='Argentina'>Argentina</option>
				<option value='Armenia'>Armenia</option>
				<option value='Australia'>Australia</option>
				<option value='Austria'>Austria</option>
				<option value='Azerbaijan'>Azerbaijan</option>
				<option value='Belarus'>Belarus</option>
				<option value='Belgium'>Belgium</option>
				<option value='Bosnia and Herzegovina'>Bosnia and Herzegovina</option>
				<option value='Brazil'>Brazil</option>
				<option value='Bulgaria'>Bulgaria</option>
				<option value='Cameroon'>Cameroon</option>
				<option value='Canada'>Canada</option>
				<option value='Chile'>Chile</option>
				<option value='Colombia'>Colombia</option>
				<option value='Costa Rica'>Costa Rica</option>
				<option value='Croatia'>Croatia</option>
				<option value='Cyprus'>Cyprus</option>
				<option value='Czech Republic'>Czech Republic</option>
				<option value='Czechoslovakia'>- Czechoslovakia</option>
				<option value='Denmark'>Denmark</option>
				<option value='Ecuador'>Ecuador</option>
				<option value='Egypt'>Egypt</option>
				<option value='England'>England</option>
				<option value='Estonia'>Estonia</option>
				<option value='Faroe Islands'>Faroe Islands</option>
				<option value='Finland'>Finland</option>
				<option value='Georgia'>Georgia</option>
				<option value='GermanyTotal'>Germany</option>
				<option value='Germany'>- reunified</option>
				<option value='West Germany'>- West</option>
				<option value='East Germany'>- East</option>
				<option value='German Reich'>- German Reich</option>
				<option value='Weimar Republic'>- Weimar Republic</option>
				<option value='Greece'>Greece</option>
				<option value='Honduras'>Honduras</option>
				<option value='Hungary'>Hungary</option>
				<option value='Iceland'>Iceland</option>
				<option value='Iran'>Iran</option>
				<option value='Ireland'>Ireland</option>
				<option value='Israel'>Israel</option>
				<option value='Italy'>Italy</option>
				<option value='Ivory Coast'>Ivory Coast</option>
				<option value='Jamaica'>Jamaica</option>
				<option value='Japan'>Japan</option>
				<option value='Kuwait'>Kuwait</option>
				<option value='Latvia'>Latvia</option>
				<option value='Lithuania'>Lithuania</option>
				<option value='Luxembourg'>Luxembourg</option>
				<option value='Malta'>Malta</option>
				<option value='Mexico'>Mexico</option>
				<option value='Morocco'>Morocco</option>
				<option value='Netherlands'>Netherlands</option>
				<option value='New Zealand'>New Zealand</option>
				<option value='Nigeria'>Nigeria</option>
				<option value='Northern Ireland'>Northern Ireland</option>
				<option value='Norway'>Norway</option>
				<option value='Paraguay'>Paraguay</option>
				<option value='Peru'>Peru</option>
				<option value='Poland'>Poland</option>
				<option value='Portugal'>Portugal</option>
				<option value='Romania'>Romania</option>
				<option value='Russia'>Russia</option>
				<option value='Soviet Union'>- Soviet Union</option>
				<option value='Saudi Arabia'>Saudi Arabia</option>
				<option value='Scotland'>Scotland</option>
				<option value='Senegal'>Senegal</option>
				<option value='Serbia'>Serbia</option>
				<option value='Yugoslavia'>- Yugoslavia</option>
				<option value='Slovakia'>Slovakia</option>
				<option value='Slovenia'>Slovenia</option>
				<option value='South Africa'>South Africa</option>
				<option value='South Korea'>South Korea</option>
				<option value='Spain'>Spain</option>
				<option value='Sweden'>Sweden</option>
				<option value='Switzerland'>Switzerland</option>
				<option value='Togo'>Togo</option>
				<option value='Tunisia'>Tunisia</option>
				<option value='Turkey'>Turkey</option>
				<option value='Ukraine'>Ukraine</option>
				<option value='United States'>United States</option>
				<option value='United States'>United States</option>
				<option value='Uruguay'>Uruguay</option>
				<option value='Vietnam'>Vietnam</option>
			</select>
		</label><br>
		
		<div style="margin-top:5px; margin-left:7px;">
			<label>
				<select id="gametype" onchange="filter(this.value);" style="border:0; font-weight:bold; font-family: Arial, sans-serif; font-size: 12px; width:125px;">
				  <option value="--Select--">All the games</option>
				  <option value="1">Competitions</option>
				  <option value="0">Friendlies</option>
				</select>
			</label> 		
		</div>
		
		<div style="margin-left:12px;">
			from
			<input type="text" id="yearMin" style="border:0; color:#666666; font-weight:bold; font-family: Arial, sans-serif; font-size: 12px; width:33px; margin-left:2px;" value="1904" onchange="sliderInput(this.value)">
			to
			<input type="text" id="yearMax" style="border:0; color:#666666; font-weight:bold; font-family: Arial, sans-serif; font-size: 12px; width:33px; margin-left:2px;" value="2015" onchange="sliderInput(this.value)">
		</div>
		<div>
			<div id="slider-range" style="margin-left:7px; margin-top:8px; width:151px;"></div>
		</div>		
		
		<div style="margin-top:5px;">
			<table>
				<tr>
					<td align='center' width='15px'><img src='icons/green_dot.png'></td>
					<td width="90px">WINS</td>
					<td width='26px' align='right'><div id="winTotal"></div></td>
					<td width='15px'><input id="winBox" type="checkbox" checked="checked"
					  value="W" name="game"></td>
				</tr>
				<tr>
					<td align='center' width='15px'><img src='icons/yellow_dot.png'></td>
					<td width="90px">DRAWS</td>
					<td width='26px' align='right'><div id="drawTotal"></div></td>
					<td width='15px'><input id="drawBox" type="checkbox" checked="checked" 
					  value="D" name="game"></td>
				</tr>
				<tr>
					<td align='center' width='15px'><img src='icons/red_dot.png'></td>
					<td width="90px">LOSSES</td>
					<td width='26px' align='right'><div id="lossTotal"></div></td>
					<td width='15px'><input id="lossBox" type="checkbox" checked="checked" 
					  value="L" name="game"></td>
				</tr>
				<tr>
					<td align='center' width='15px'><img src='icons/blue_dot.png'></td>
					<td width="90px">future matches</td>
					<td width='26px' align='right'><div id="futureTotal"></div></td>
					<td width='15px'><input id="futureBox" type="checkbox" checked="checked" 
					  value="U" name="game"></td>
				</tr>			
			</table>
		</div>

		<div style='margin-top:10px' align='center'>
		Record<br>
		<img src='icons/legende.png' style='margin-top:3px'>
		</div>
		
		<div style='margin-top:5px' align='center'>
		Number of matches<br>
		<img src='icons/legende2.png' style='margin-top:3px'>
		</div>
		
		<div style='margin-top:2px; text-align:right; font-size:8px; font-color:#ccc;'><a target="_blank" href='http://de.wikipedia.org/wiki/Liste_der_L%C3%A4nderspiele_der_franz%C3%B6sischen_Fu%C3%9Fballnationalmannschaft'>source</a> <a target="_blank" href='http://en.wikipedia.org/wiki/France_national_football_team_all-time_record'>(in English)</a></div>
		
	</div>
	
  </body>
</html>